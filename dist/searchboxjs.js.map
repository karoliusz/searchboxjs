{"version":3,"file":"searchboxjs.js","sources":["../src/ts/utils/BrowserEventManager.ts","../src/ts/utils/State.ts","../src/ts/utils/domUtils.ts","../src/ts/constants.ts","../src/ts/SearchBoxResultList.ts","../src/ts/SearchBox.ts"],"sourcesContent":["type ListenerFn<T> = (event: T) => void;\r\n\r\ninterface RegisteredListener {\r\n    type: keyof HTMLElementEventMap;\r\n    fn: ListenerFn<unknown>;\r\n}\r\n\r\nexport class BrowserEventManager {\r\n    private eventListeners: Array<RegisteredListener> = [];\r\n\r\n    constructor(private element: Element) {}\r\n\r\n    public addListener<T extends keyof HTMLElementEventMap>(type: T, fn: ListenerFn<HTMLElementEventMap[T]>) {\r\n        this.element.addEventListener(type, fn);\r\n        this.eventListeners.push({ type, fn });\r\n    }\r\n\r\n    public dispose() {\r\n        this.eventListeners.forEach(({ type, fn }) => {\r\n            this.element.removeEventListener(type, fn);\r\n        });\r\n\r\n        this.eventListeners.length = 0;\r\n        this.element = null;\r\n    }\r\n}\r\n","import { BehaviorSubject, distinctUntilChanged, Observable } from 'rxjs';\r\n\r\nimport { StateCompareFn } from '../interfaces';\r\n\r\nexport class State<T extends object> {\r\n    static areEqualShallow(a: object, b: object): boolean {\r\n        for (let key in a) {\r\n            if (!(key in b) || a[key] !== b[key]) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        for (let key in b) {\r\n            if (!(key in a)) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    private lastBroadcastedState: T = null;\r\n    private compareState: StateCompareFn<T>;\r\n\r\n    private stateSource: BehaviorSubject<T>;\r\n    private _state$: Observable<T>;\r\n\r\n    public get state$(): Observable<T> {\r\n        return this._state$;\r\n    }\r\n\r\n    constructor(initialState: T) {\r\n        this.lastBroadcastedState = { ...initialState };\r\n        this.compareState = this.defaultCompareState;\r\n        this.stateSource = new BehaviorSubject(this.lastBroadcastedState);\r\n        this._state$ = this.stateSource.pipe(\r\n            distinctUntilChanged(this.compareState)\r\n        );\r\n    }\r\n\r\n    public setState(state: Partial<T>): void {\r\n        this.lastBroadcastedState = { ...this.lastBroadcastedState, ...state };\r\n        this.stateSource.next(this.lastBroadcastedState);\r\n    }\r\n\r\n    private defaultCompareState(a: T, b: T): boolean {\r\n        return State.areEqualShallow(a, b);\r\n    }\r\n}\r\n","export function getPathBetweenElements(ancestor: HTMLElement, descendant: HTMLElement): Array<HTMLElement> {\r\n    if (!ancestor || !descendant || !ancestor.contains(descendant)) {\r\n        return null;\r\n    }\r\n\r\n    if (ancestor === descendant) {\r\n        return [ancestor];\r\n    }\r\n\r\n    const path: Array<HTMLElement> = [descendant];\r\n    let currentNode = descendant;\r\n\r\n    while (currentNode.parentNode && currentNode.parentNode !== ancestor) {\r\n        currentNode = currentNode.parentNode as HTMLElement;\r\n        path.unshift(currentNode);\r\n    }\r\n\r\n    path.unshift(ancestor);\r\n    \r\n    return path;\r\n}","export const SEARCH_BOX_LIST_DEFAULT_Z_INDEX = 10;\r\n\r\nexport const DEFAULT_CLASS_NAMES = {\r\n    searchBoxList: {\r\n        defaultClassName: \"searchBoxList\",\r\n        itemDefaultClassName: \"searchBoxList__item\",\r\n        itemButtonDefaultClassName: \"searchBoxList__itemButton\",\r\n        messageClassName: \"searchBoxList__message\",\r\n        loadingIndicatorClassName: \"searchBoxList__loadingIndicator\"\r\n    }\r\n} as const;\r\n\r\nexport const TEXT = {\r\n    noResultsFound: \"Sorry, can't find a match for your search phrase!\",\r\n    loading: \"Loading your resultsâ€¦\"\r\n} as const;\r\n","import { getPathBetweenElements, BrowserEventManager } from \"./utils\";\r\nimport { DEFAULT_CLASS_NAMES, SEARCH_BOX_LIST_DEFAULT_Z_INDEX, TEXT } from \"./constants\";\r\n\r\ninterface SearchBoxResultListOptions<T> {\r\n    onFocus?: () => void;\r\n    onBlur?: () => void;\r\n    onItemSelect?: (value: T) => void;\r\n}\r\n\r\nexport class SearchBoxResultList<T> {\r\n    static escapeHTML(unescaped: string): string {\r\n        return unescaped\r\n            .replace(/&/g, \"&amp;\")\r\n            .replace(/</g, \"&lt;\")\r\n            .replace(/>/g, \"&gt;\")\r\n            .replace(/\"/g, \"&quot;\")\r\n            .replace(/'/g, \"&#039;\");\r\n    }\r\n\r\n    private listElementEvents: BrowserEventManager = null;\r\n    private documentEvents: BrowserEventManager = null;\r\n    private listElement: HTMLUListElement = null;\r\n    private items: T[] = [];\r\n    private visible = false;\r\n\r\n    private isFocused = false;\r\n\r\n    constructor(\r\n        private inputElement: Element,\r\n        private itemTemplate: string,\r\n        private options: SearchBoxResultListOptions<T> = {}\r\n    ) {\r\n        this.initializeListElement();\r\n        this.listElementEvents = new BrowserEventManager(this.listElement);\r\n        this.documentEvents = new BrowserEventManager(window.document.documentElement);\r\n        this.listElement.style.position = 'fixed';\r\n        this.listElement.style.zIndex = String(SEARCH_BOX_LIST_DEFAULT_Z_INDEX);\r\n\r\n        this.listElementEvents.addListener('mousedown', event => {\r\n            this.setFocus();\r\n        });\r\n\r\n        this.listElementEvents.addListener('click', event => {\r\n            const target = event.target;\r\n\r\n            if (target instanceof HTMLElement) {\r\n                const selectedItem = this.getSelectedItem(target);\r\n            \r\n                this.options.onItemSelect(selectedItem);\r\n            }\r\n        });\r\n\r\n        this.documentEvents.addListener('mousedown', event => {\r\n            const clickedElement = event.target as HTMLElement;\r\n\r\n            if (this.isFocused && !this.listElement.contains(clickedElement)) {\r\n                this.blur();\r\n            }\r\n        });\r\n    }\r\n\r\n    public setItems(items: T[]) {\r\n        const { searchBoxList: { messageClassName } } = DEFAULT_CLASS_NAMES;\r\n\r\n        this.clearList();\r\n\r\n        if (items.length) {\r\n            this.items = items;\r\n            this.items.forEach((item, index) => {\r\n                this.listElement.appendChild(this.createListItem(item, index));\r\n            });\r\n        } else {\r\n            this.listElement.innerHTML = `<div class=\"${messageClassName}\">${TEXT.noResultsFound}</div>`\r\n        }\r\n    }\r\n\r\n    public beginLoading() {\r\n        const { searchBoxList: { messageClassName, loadingIndicatorClassName } } = DEFAULT_CLASS_NAMES;\r\n\r\n        this.clearList();\r\n\r\n        this.listElement.innerHTML = `\r\n            <div class=\"${messageClassName}\">\r\n                <div class=\"${loadingIndicatorClassName}\"></div>\r\n                ${TEXT.loading}\r\n            </div>\r\n        `\r\n    }\r\n\r\n    public show() {\r\n        const { bottom, right } = this.inputElement.getBoundingClientRect();\r\n        const viewportWidth = document.documentElement.clientWidth;\r\n\r\n        this.listElement.style.display = 'block';\r\n        this.listElement.style.top = `${bottom}px`;\r\n        this.listElement.style.right = `${viewportWidth - right}px`;\r\n        this.visible = true;\r\n    }\r\n\r\n    public hide() {\r\n        if (this.visible) {\r\n            this.visible = false;\r\n            this.listElement.style.display = 'none';\r\n            this.blur();\r\n        }\r\n    }\r\n\r\n    public setFocus() {\r\n        if (!this.isFocused) {\r\n            this.isFocused = true;\r\n            this.options.onFocus && this.options.onFocus();\r\n        }\r\n    }\r\n\r\n    public blur() {\r\n        if (this.isFocused) {\r\n            this.isFocused = false;\r\n            this.options.onBlur && this.options.onBlur();\r\n        }\r\n    }\r\n\r\n    public dispose() {\r\n        this.inputElement = null;\r\n        this.listElementEvents.dispose();\r\n        this.documentEvents.dispose();\r\n    }\r\n\r\n    private getSelectedItem(clickedElement: HTMLElement): T {\r\n        const { searchBoxList: { itemButtonDefaultClassName } } = DEFAULT_CLASS_NAMES;\r\n        const path = getPathBetweenElements(this.listElement, clickedElement);\r\n        const button = path?.find(element => element.tagName === 'BUTTON' && element.classList.contains(itemButtonDefaultClassName));\r\n\r\n        if (button?.tagName === 'BUTTON' && button.classList.contains(itemButtonDefaultClassName)) {\r\n            const itemIndex = typeof button?.dataset.index === 'string' ? Number(button.dataset.index) : null;\r\n            const selectedItem = this.items[itemIndex] || null;\r\n        \r\n            return selectedItem;\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    private clearList() {\r\n        this.items = [];\r\n        this.listElement.innerHTML = '';\r\n    }\r\n\r\n    private initializeListElement() {\r\n        const { searchBoxList: { defaultClassName } } = DEFAULT_CLASS_NAMES;\r\n\r\n        this.listElement = document.createElement('ul');\r\n        this.listElement.classList.add(defaultClassName);\r\n        this.listElement.style.display = 'none';\r\n        document.body.append(this.listElement);\r\n        this.beginLoading();\r\n    }\r\n\r\n    private createListItem(item: T, index: number) {\r\n        const listItemElement = document.createElement('li');\r\n        const buttonElement = document.createElement('button');\r\n        const htmlContent = this.getItemHTML(item, this.itemTemplate);\r\n        const { searchBoxList: { itemButtonDefaultClassName, defaultClassName } } = DEFAULT_CLASS_NAMES;\r\n\r\n        buttonElement.setAttribute('data-index', String(index));\r\n        buttonElement.setAttribute('type', 'button');\r\n        buttonElement.innerHTML = htmlContent;\r\n        buttonElement.classList.add(itemButtonDefaultClassName);\r\n        listItemElement.appendChild(buttonElement);\r\n        listItemElement.classList.add(defaultClassName);\r\n\r\n        return listItemElement;\r\n    }\r\n\r\n    private getItemHTML(item: T, itemTemplate: string) {\r\n        return itemTemplate.replace(/{{(.+)}}/g, (stringToReplace, enclosedParameterName) => {\r\n            const parameterName = enclosedParameterName.trim();\r\n            const value = item[parameterName] ?? null;\r\n            const valueToRender = value === null ? '' : String(value);\r\n\r\n            return SearchBoxResultList.escapeHTML(valueToRender);\r\n        });\r\n    }\r\n}\r\n","import { Subscription } from \"rxjs\";\r\nimport { SearchBoxDataSource } from \"./dataLayer/interfaces\";\r\nimport { SearchBoxOptions } from \"./interfaces\";\r\nimport { SearchBoxResultList } from \"./SearchBoxResultList\";\r\nimport { State } from \"./utils\";\r\n\r\ninterface SearchBoxState<T = unknown> {\r\n    inputFocused: boolean;\r\n    resultListFocused: boolean;\r\n    inputValue: string;\r\n    selectedItem: T\r\n}\r\n\r\n/**\r\n * SearchBox component\r\n * \r\n * @param itemTemplate Provides HTML template for found items. Parameter names enclosed with {{ and }} will be replaced with their values from the item object. Example: <span class=\"itemName\">{{name}}</span>\r\n */\r\nexport class SearchBox<T> {\r\n    // private input: SearchBoxInput = null;\r\n    private resultList: SearchBoxResultList<T> = null;\r\n    private isInitializing = false;\r\n    private isInitialized = false;\r\n\r\n    private state: State<SearchBoxState<T>> = null;\r\n    private stateSubscription: Subscription;\r\n\r\n    constructor(\r\n        private inputElement: HTMLElement,\r\n        private dataSource: SearchBoxDataSource<T>,\r\n        private itemTemplate: string,\r\n        private searchKeys: Array<keyof T>,\r\n        private options: SearchBoxOptions<T> = {}) {\r\n\r\n        if (!(inputElement instanceof HTMLInputElement)) {\r\n            throw new Error('Input element must be a valid HTMLInputElement!');\r\n        }\r\n\r\n        this.state = new State<SearchBoxState<T>>({\r\n            inputFocused: false,\r\n            resultListFocused: false,\r\n            inputValue: '',\r\n            selectedItem: null\r\n        });\r\n\r\n        // this.input = new SearchBoxInput(inputElement, {\r\n        //     onFocus: () => this.state.setState({ inputFocused: true, resultListFocused: false }),\r\n        //     onBlur: () => this.state.setState({ inputFocused: false }),\r\n        //     onValueChange: value => this.state.setState({ inputValue: value })\r\n        // });\r\n\r\n        this.resultList = new SearchBoxResultList(inputElement, itemTemplate, {\r\n            onFocus: () => this.state.setState({ resultListFocused: true }),\r\n            onBlur: () => this.state.setState({ resultListFocused: false }),\r\n            onItemSelect: item => this.state.setState({ selectedItem: item })\r\n        });\r\n\r\n        this.stateSubscription = this.state.state$.subscribe(event => this.onStateChange(event));\r\n    }\r\n\r\n    dispose() {\r\n        // this.input.dispose();\r\n        this.resultList.dispose();\r\n        this.inputElement = null;\r\n        this.stateSubscription.unsubscribe();\r\n    }\r\n\r\n    private initialize() {\r\n        this.isInitializing = true;\r\n\r\n        this.dataSource.getItems('', 10, this.searchKeys)\r\n            .then(data => {\r\n                this.resultList.setItems(data);\r\n                this.isInitialized = true;\r\n                this.isInitializing = false;\r\n            });\r\n    }\r\n\r\n    private onStateChange(event: SearchBoxState<T>) {\r\n        console.log('state changed', event);\r\n\r\n        if (event.selectedItem && this.options.onItemSelect) {\r\n            this.options.onItemSelect(event.selectedItem);\r\n        }\r\n\r\n        // if (event.inputFocused) {\r\n        //     if (!this.isInitializing && !this.isInitialized) {\r\n        //         this.initialize();\r\n        //     }\r\n\r\n        //     this.resultList.show();\r\n        // } else if (!event.resultListFocused) {\r\n        //     this.resultList.hide();\r\n        // }\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;AAAO,MAAM,mBAAmB,CAAC;AACjC,EAAE,WAAW,CAAC,OAAO,EAAE;AACvB,IAAI,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;AAC3B,GAAG;AACH,EAAE,cAAc,GAAG,EAAE,CAAC;AACtB,EAAE,WAAW,CAAC,IAAI,EAAE,EAAE,EAAE;AACxB,IAAI,IAAI,CAAC,OAAO,CAAC,gBAAgB,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;AAC5C,IAAI,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,EAAE,EAAE,CAAC,CAAC;AAC3C,GAAG;AACH,EAAE,OAAO,GAAG;AACZ,IAAI,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,EAAE,EAAE,KAAK;AAClD,MAAM,IAAI,CAAC,OAAO,CAAC,mBAAmB,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;AACjD,KAAK,CAAC,CAAC;AACP,IAAI,IAAI,CAAC,cAAc,CAAC,MAAM,GAAG,CAAC,CAAC;AACnC,IAAI,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;AACxB,GAAG;AACH;;ACfO,MAAM,KAAK,CAAC;AACnB,EAAE,OAAO,eAAe,CAAC,CAAC,EAAE,CAAC,EAAE;AAC/B,IAAI,KAAK,IAAI,GAAG,IAAI,CAAC,EAAE;AACvB,MAAM,IAAI,EAAE,GAAG,IAAI,CAAC,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,GAAG,CAAC,EAAE;AAC5C,QAAQ,OAAO,KAAK,CAAC;AACrB,OAAO;AACP,KAAK;AACL,IAAI,KAAK,IAAI,GAAG,IAAI,CAAC,EAAE;AACvB,MAAM,IAAI,EAAE,GAAG,IAAI,CAAC,CAAC,EAAE;AACvB,QAAQ,OAAO,KAAK,CAAC;AACrB,OAAO;AACP,KAAK;AACL,IAAI,OAAO,IAAI,CAAC;AAChB,GAAG;AACH,EAAE,oBAAoB,GAAG,IAAI,CAAC;AAC9B,EAAE,YAAY,CAAC;AACf,EAAE,WAAW,CAAC;AACd,EAAE,OAAO,CAAC;AACV,EAAE,IAAI,MAAM,GAAG;AACf,IAAI,OAAO,IAAI,CAAC,OAAO,CAAC;AACxB,GAAG;AACH,EAAE,WAAW,CAAC,YAAY,EAAE;AAC5B,IAAI,IAAI,CAAC,oBAAoB,GAAG,EAAE,GAAG,YAAY,EAAE,CAAC;AACpD,IAAI,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,mBAAmB,CAAC;AACjD,IAAI,IAAI,CAAC,WAAW,GAAG,IAAI,eAAe,CAAC,IAAI,CAAC,oBAAoB,CAAC,CAAC;AACtE,IAAI,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC;AAClF,GAAG;AACH,EAAE,QAAQ,CAAC,KAAK,EAAE;AAClB,IAAI,IAAI,CAAC,oBAAoB,GAAG,EAAE,GAAG,IAAI,CAAC,oBAAoB,EAAE,GAAG,KAAK,EAAE,CAAC;AAC3E,IAAI,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,oBAAoB,CAAC,CAAC;AACrD,GAAG;AACH,EAAE,mBAAmB,CAAC,CAAC,EAAE,CAAC,EAAE;AAC5B,IAAI,OAAO,KAAK,CAAC,eAAe,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;AACvC,GAAG;AACH;;ACnCO,SAAS,sBAAsB,CAAC,QAAQ,EAAE,UAAU,EAAE;AAC7D,EAAE,IAAI,CAAC,QAAQ,IAAI,CAAC,UAAU,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,UAAU,CAAC,EAAE;AAClE,IAAI,OAAO,IAAI,CAAC;AAChB,GAAG;AACH,EAAE,IAAI,QAAQ,KAAK,UAAU,EAAE;AAC/B,IAAI,OAAO,CAAC,QAAQ,CAAC,CAAC;AACtB,GAAG;AACH,EAAE,MAAM,IAAI,GAAG,CAAC,UAAU,CAAC,CAAC;AAC5B,EAAE,IAAI,WAAW,GAAG,UAAU,CAAC;AAC/B,EAAE,OAAO,WAAW,CAAC,UAAU,IAAI,WAAW,CAAC,UAAU,KAAK,QAAQ,EAAE;AACxE,IAAI,WAAW,GAAG,WAAW,CAAC,UAAU,CAAC;AACzC,IAAI,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC;AAC9B,GAAG;AACH,EAAE,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;AACzB,EAAE,OAAO,IAAI,CAAC;AACd;;ACfO,MAAM,+BAA+B,GAAG,EAAE,CAAC;AAC3C,MAAM,mBAAmB,GAAG;AACnC,EAAE,aAAa,EAAE;AACjB,IAAI,gBAAgB,EAAE,eAAe;AACrC,IAAI,oBAAoB,EAAE,qBAAqB;AAC/C,IAAI,0BAA0B,EAAE,2BAA2B;AAC3D,IAAI,gBAAgB,EAAE,wBAAwB;AAC9C,IAAI,yBAAyB,EAAE,iCAAiC;AAChE,GAAG;AACH,CAAC,CAAC;AACK,MAAM,IAAI,GAAG;AACpB,EAAE,cAAc,EAAE,mDAAmD;AACrE,EAAE,OAAO,EAAE,4BAA4B;AACvC,CAAC;;ACXM,MAAM,mBAAmB,CAAC;AACjC,EAAE,WAAW,CAAC,YAAY,EAAE,YAAY,EAAE,OAAO,GAAG,EAAE,EAAE;AACxD,IAAI,IAAI,CAAC,YAAY,GAAG,YAAY,CAAC;AACrC,IAAI,IAAI,CAAC,YAAY,GAAG,YAAY,CAAC;AACrC,IAAI,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;AAC3B,IAAI,IAAI,CAAC,qBAAqB,EAAE,CAAC;AACjC,IAAI,IAAI,CAAC,iBAAiB,GAAG,IAAI,mBAAmB,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;AACvE,IAAI,IAAI,CAAC,cAAc,GAAG,IAAI,mBAAmB,CAAC,MAAM,CAAC,QAAQ,CAAC,eAAe,CAAC,CAAC;AACnF,IAAI,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,QAAQ,GAAG,OAAO,CAAC;AAC9C,IAAI,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,MAAM,GAAG,MAAM,CAAC,+BAA+B,CAAC,CAAC;AAC5E,IAAI,IAAI,CAAC,iBAAiB,CAAC,WAAW,CAAC,WAAW,EAAE,CAAC,KAAK,KAAK;AAC/D,MAAM,IAAI,CAAC,QAAQ,EAAE,CAAC;AACtB,KAAK,CAAC,CAAC;AACP,IAAI,IAAI,CAAC,iBAAiB,CAAC,WAAW,CAAC,OAAO,EAAE,CAAC,KAAK,KAAK;AAC3D,MAAM,MAAM,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC;AAClC,MAAM,IAAI,MAAM,YAAY,WAAW,EAAE;AACzC,QAAQ,MAAM,YAAY,GAAG,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC;AAC1D,QAAQ,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,YAAY,CAAC,CAAC;AAChD,OAAO;AACP,KAAK,CAAC,CAAC;AACP,IAAI,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,WAAW,EAAE,CAAC,KAAK,KAAK;AAC5D,MAAM,MAAM,cAAc,GAAG,KAAK,CAAC,MAAM,CAAC;AAC1C,MAAM,IAAI,IAAI,CAAC,SAAS,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,cAAc,CAAC,EAAE;AACxE,QAAQ,IAAI,CAAC,IAAI,EAAE,CAAC;AACpB,OAAO;AACP,KAAK,CAAC,CAAC;AACP,GAAG;AACH,EAAE,OAAO,UAAU,CAAC,SAAS,EAAE;AAC/B,IAAI,OAAO,SAAS,CAAC,OAAO,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC,OAAO,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC,OAAO,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC,OAAO,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC,OAAO,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;AACxI,GAAG;AACH,EAAE,iBAAiB,GAAG,IAAI,CAAC;AAC3B,EAAE,cAAc,GAAG,IAAI,CAAC;AACxB,EAAE,WAAW,GAAG,IAAI,CAAC;AACrB,EAAE,KAAK,GAAG,EAAE,CAAC;AACb,EAAE,OAAO,GAAG,KAAK,CAAC;AAClB,EAAE,SAAS,GAAG,KAAK,CAAC;AACpB,EAAE,QAAQ,CAAC,KAAK,EAAE;AAClB,IAAI,MAAM,EAAE,aAAa,EAAE,EAAE,gBAAgB,EAAE,EAAE,GAAG,mBAAmB,CAAC;AACxE,IAAI,IAAI,CAAC,SAAS,EAAE,CAAC;AACrB,IAAI,IAAI,KAAK,CAAC,MAAM,EAAE;AACtB,MAAM,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;AACzB,MAAM,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,IAAI,EAAE,KAAK,KAAK;AAC1C,QAAQ,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,IAAI,CAAC,cAAc,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC,CAAC;AACvE,OAAO,CAAC,CAAC;AACT,KAAK,MAAM;AACX,MAAM,IAAI,CAAC,WAAW,CAAC,SAAS,GAAG,CAAC,YAAY,EAAE,gBAAgB,CAAC,EAAE,EAAE,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,CAAC;AACnG,KAAK;AACL,GAAG;AACH,EAAE,YAAY,GAAG;AACjB,IAAI,MAAM,EAAE,aAAa,EAAE,EAAE,gBAAgB,EAAE,yBAAyB,EAAE,EAAE,GAAG,mBAAmB,CAAC;AACnG,IAAI,IAAI,CAAC,SAAS,EAAE,CAAC;AACrB,IAAI,IAAI,CAAC,WAAW,CAAC,SAAS,GAAG,CAAC;AAClC,wBAAwB,EAAE,gBAAgB,CAAC;AAC3C,4BAA4B,EAAE,yBAAyB,CAAC;AACxD,gBAAgB,EAAE,IAAI,CAAC,OAAO,CAAC;AAC/B;AACA,QAAQ,CAAC,CAAC;AACV,GAAG;AACH,EAAE,IAAI,GAAG;AACT,IAAI,MAAM,EAAE,MAAM,EAAE,KAAK,EAAE,GAAG,IAAI,CAAC,YAAY,CAAC,qBAAqB,EAAE,CAAC;AACxE,IAAI,MAAM,aAAa,GAAG,QAAQ,CAAC,eAAe,CAAC,WAAW,CAAC;AAC/D,IAAI,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,OAAO,GAAG,OAAO,CAAC;AAC7C,IAAI,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,GAAG,GAAG,CAAC,EAAE,MAAM,CAAC,EAAE,CAAC,CAAC;AAC/C,IAAI,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,KAAK,GAAG,CAAC,EAAE,aAAa,GAAG,KAAK,CAAC,EAAE,CAAC,CAAC;AAChE,IAAI,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;AACxB,GAAG;AACH,EAAE,IAAI,GAAG;AACT,IAAI,IAAI,IAAI,CAAC,OAAO,EAAE;AACtB,MAAM,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;AAC3B,MAAM,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;AAC9C,MAAM,IAAI,CAAC,IAAI,EAAE,CAAC;AAClB,KAAK;AACL,GAAG;AACH,EAAE,QAAQ,GAAG;AACb,IAAI,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE;AACzB,MAAM,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;AAC5B,MAAM,IAAI,CAAC,OAAO,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,CAAC;AACrD,KAAK;AACL,GAAG;AACH,EAAE,IAAI,GAAG;AACT,IAAI,IAAI,IAAI,CAAC,SAAS,EAAE;AACxB,MAAM,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;AAC7B,MAAM,IAAI,CAAC,OAAO,CAAC,MAAM,IAAI,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC;AACnD,KAAK;AACL,GAAG;AACH,EAAE,OAAO,GAAG;AACZ,IAAI,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;AAC7B,IAAI,IAAI,CAAC,iBAAiB,CAAC,OAAO,EAAE,CAAC;AACrC,IAAI,IAAI,CAAC,cAAc,CAAC,OAAO,EAAE,CAAC;AAClC,GAAG;AACH,EAAE,eAAe,CAAC,cAAc,EAAE;AAClC,IAAI,MAAM,EAAE,aAAa,EAAE,EAAE,0BAA0B,EAAE,EAAE,GAAG,mBAAmB,CAAC;AAClF,IAAI,MAAM,IAAI,GAAG,sBAAsB,CAAC,IAAI,CAAC,WAAW,EAAE,cAAc,CAAC,CAAC;AAC1E,IAAI,MAAM,MAAM,GAAG,IAAI,EAAE,IAAI,CAAC,CAAC,OAAO,KAAK,OAAO,CAAC,OAAO,KAAK,QAAQ,IAAI,OAAO,CAAC,SAAS,CAAC,QAAQ,CAAC,0BAA0B,CAAC,CAAC,CAAC;AACnI,IAAI,IAAI,MAAM,EAAE,OAAO,KAAK,QAAQ,IAAI,MAAM,CAAC,SAAS,CAAC,QAAQ,CAAC,0BAA0B,CAAC,EAAE;AAC/F,MAAM,MAAM,SAAS,GAAG,OAAO,MAAM,EAAE,OAAO,CAAC,KAAK,KAAK,QAAQ,GAAG,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG,IAAI,CAAC;AACxG,MAAM,MAAM,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,IAAI,IAAI,CAAC;AACzD,MAAM,OAAO,YAAY,CAAC;AAC1B,KAAK,MAAM;AACX,MAAM,OAAO,IAAI,CAAC;AAClB,KAAK;AACL,GAAG;AACH,EAAE,SAAS,GAAG;AACd,IAAI,IAAI,CAAC,KAAK,GAAG,EAAE,CAAC;AACpB,IAAI,IAAI,CAAC,WAAW,CAAC,SAAS,GAAG,EAAE,CAAC;AACpC,GAAG;AACH,EAAE,qBAAqB,GAAG;AAC1B,IAAI,MAAM,EAAE,aAAa,EAAE,EAAE,gBAAgB,EAAE,EAAE,GAAG,mBAAmB,CAAC;AACxE,IAAI,IAAI,CAAC,WAAW,GAAG,QAAQ,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;AACpD,IAAI,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC;AACrD,IAAI,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;AAC5C,IAAI,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;AAC3C,IAAI,IAAI,CAAC,YAAY,EAAE,CAAC;AACxB,GAAG;AACH,EAAE,cAAc,CAAC,IAAI,EAAE,KAAK,EAAE;AAC9B,IAAI,MAAM,eAAe,GAAG,QAAQ,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;AACzD,IAAI,MAAM,aAAa,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;AAC3D,IAAI,MAAM,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,EAAE,IAAI,CAAC,YAAY,CAAC,CAAC;AAClE,IAAI,MAAM,EAAE,aAAa,EAAE,EAAE,0BAA0B,EAAE,gBAAgB,EAAE,EAAE,GAAG,mBAAmB,CAAC;AACpG,IAAI,aAAa,CAAC,YAAY,CAAC,YAAY,EAAE,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC;AAC5D,IAAI,aAAa,CAAC,YAAY,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;AACjD,IAAI,aAAa,CAAC,SAAS,GAAG,WAAW,CAAC;AAC1C,IAAI,aAAa,CAAC,SAAS,CAAC,GAAG,CAAC,0BAA0B,CAAC,CAAC;AAC5D,IAAI,eAAe,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC;AAC/C,IAAI,eAAe,CAAC,SAAS,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC;AACpD,IAAI,OAAO,eAAe,CAAC;AAC3B,GAAG;AACH,EAAE,WAAW,CAAC,IAAI,EAAE,YAAY,EAAE;AAClC,IAAI,OAAO,YAAY,CAAC,OAAO,CAAC,WAAW,EAAE,CAAC,eAAe,EAAE,qBAAqB,KAAK;AACzF,MAAM,MAAM,aAAa,GAAG,qBAAqB,CAAC,IAAI,EAAE,CAAC;AACzD,MAAM,MAAM,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,IAAI,IAAI,CAAC;AAChD,MAAM,MAAM,aAAa,GAAG,KAAK,KAAK,IAAI,GAAG,EAAE,GAAG,MAAM,CAAC,KAAK,CAAC,CAAC;AAChE,MAAM,OAAO,mBAAmB,CAAC,UAAU,CAAC,aAAa,CAAC,CAAC;AAC3D,KAAK,CAAC,CAAC;AACP,GAAG;AACH;;ACvIO,MAAM,SAAS,CAAC;AACvB,EAAE,WAAW,CAAC,YAAY,EAAE,UAAU,EAAE,YAAY,EAAE,UAAU,EAAE,OAAO,GAAG,EAAE,EAAE;AAChF,IAAI,IAAI,CAAC,YAAY,GAAG,YAAY,CAAC;AACrC,IAAI,IAAI,CAAC,UAAU,GAAG,UAAU,CAAC;AACjC,IAAI,IAAI,CAAC,YAAY,GAAG,YAAY,CAAC;AACrC,IAAI,IAAI,CAAC,UAAU,GAAG,UAAU,CAAC;AACjC,IAAI,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;AAC3B,IAAI,IAAI,EAAE,YAAY,YAAY,gBAAgB,CAAC,EAAE;AACrD,MAAM,MAAM,IAAI,KAAK,CAAC,iDAAiD,CAAC,CAAC;AACzE,KAAK;AACL,IAAI,IAAI,CAAC,KAAK,GAAG,IAAI,KAAK,CAAC;AAC3B,MAAM,YAAY,EAAE,KAAK;AACzB,MAAM,iBAAiB,EAAE,KAAK;AAC9B,MAAM,UAAU,EAAE,EAAE;AACpB,MAAM,YAAY,EAAE,IAAI;AACxB,KAAK,CAAC,CAAC;AACP,IAAI,IAAI,CAAC,UAAU,GAAG,IAAI,mBAAmB,CAAC,YAAY,EAAE,YAAY,EAAE;AAC1E,MAAM,OAAO,EAAE,MAAM,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,EAAE,iBAAiB,EAAE,IAAI,EAAE,CAAC;AACrE,MAAM,MAAM,EAAE,MAAM,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,EAAE,iBAAiB,EAAE,KAAK,EAAE,CAAC;AACrE,MAAM,YAAY,EAAE,CAAC,IAAI,KAAK,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,EAAE,YAAY,EAAE,IAAI,EAAE,CAAC;AACzE,KAAK,CAAC,CAAC;AACP,IAAI,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,KAAK,KAAK,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC,CAAC;AAC/F,GAAG;AACH,EAAE,UAAU,GAAG,IAAI,CAAC;AACpB,EAAE,cAAc,GAAG,KAAK,CAAC;AACzB,EAAE,aAAa,GAAG,KAAK,CAAC;AACxB,EAAE,KAAK,GAAG,IAAI,CAAC;AACf,EAAE,iBAAiB,CAAC;AACpB,EAAE,OAAO,GAAG;AACZ,IAAI,IAAI,CAAC,UAAU,CAAC,OAAO,EAAE,CAAC;AAC9B,IAAI,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;AAC7B,IAAI,IAAI,CAAC,iBAAiB,CAAC,WAAW,EAAE,CAAC;AACzC,GAAG;AACH,EAAE,UAAU,GAAG;AACf,IAAI,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC;AAC/B,IAAI,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,EAAE,EAAE,EAAE,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,KAAK;AACrE,MAAM,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;AACrC,MAAM,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC;AAChC,MAAM,IAAI,CAAC,cAAc,GAAG,KAAK,CAAC;AAClC,KAAK,CAAC,CAAC;AACP,GAAG;AACH,EAAE,aAAa,CAAC,KAAK,EAAE;AACvB,IAAI,OAAO,CAAC,GAAG,CAAC,eAAe,EAAE,KAAK,CAAC,CAAC;AACxC,IAAI,IAAI,KAAK,CAAC,YAAY,IAAI,IAAI,CAAC,OAAO,CAAC,YAAY,EAAE;AACzD,MAAM,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,KAAK,CAAC,YAAY,CAAC,CAAC;AACpD,KAAK;AACL,GAAG;AACH;;;;"}