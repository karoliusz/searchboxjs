var SearchBoxJS=function(B){"use strict";var D=function(n,e){return D=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},D(n,e)};function S(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");D(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function Mt(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(c){try{u(r.next(c))}catch(p){s(p)}}function l(c){try{u(r.throw(c))}catch(p){s(p)}}function u(c){c.done?o(c.value):i(c.value).then(a,l)}u((r=r.apply(n,e||[])).next())})}function tt(n,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(u){return function(c){return l([u,c])}}function l(u){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,i&&(o=u[0]&2?i.return:u[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,u[1])).done)return o;switch(i=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,i=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){t.label=u[1];break}if(u[0]===6&&t.label<o[1]){t.label=o[1],o=u;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(u);break}o[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(n,t)}catch(c){u=[6,c],i=0}finally{r=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function I(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function x(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),i,o=[],s;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(a){s={error:a}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(s)throw s.error}}return o}function L(n,e,t){if(t||arguments.length===2)for(var r=0,i=e.length,o;r<i;r++)(o||!(r in e))&&(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return n.concat(o||Array.prototype.slice.call(e))}function _(n){return this instanceof _?(this.v=n,this):new _(n)}function Nt(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(f){r[f]&&(i[f]=function(v){return new Promise(function(w,d){o.push([f,v,w,d])>1||a(f,v)})})}function a(f,v){try{l(r[f](v))}catch(w){p(o[0][3],w)}}function l(f){f.value instanceof _?Promise.resolve(f.value.v).then(u,c):p(o[0][2],f)}function u(f){a("next",f)}function c(f){a("throw",f)}function p(f,v){f(v),o.shift(),o.length&&a(o[0][0],o[0][1])}}function kt(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof I=="function"?I(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(o){t[o]=n[o]&&function(s){return new Promise(function(a,l){s=n[o](s),i(a,l,s.done,s.value)})}}function i(o,s,a,l){Promise.resolve(l).then(function(u){o({value:u,done:a})},s)}}function h(n){return typeof n=="function"}function H(n){var e=function(r){Error.call(r),r.stack=new Error().stack},t=n(e);return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var $=H(function(n){return function(t){n(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(r,i){return i+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t}});function F(n,e){if(n){var t=n.indexOf(e);0<=t&&n.splice(t,1)}}var O=function(){function n(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return n.prototype.unsubscribe=function(){var e,t,r,i,o;if(!this.closed){this.closed=!0;var s=this._parentage;if(s)if(this._parentage=null,Array.isArray(s))try{for(var a=I(s),l=a.next();!l.done;l=a.next()){var u=l.value;u.remove(this)}}catch(d){e={error:d}}finally{try{l&&!l.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}else s.remove(this);var c=this.initialTeardown;if(h(c))try{c()}catch(d){o=d instanceof $?d.errors:[d]}var p=this._finalizers;if(p){this._finalizers=null;try{for(var f=I(p),v=f.next();!v.done;v=f.next()){var w=v.value;try{rt(w)}catch(d){o=o!=null?o:[],d instanceof $?o=L(L([],x(o)),x(d.errors)):o.push(d)}}}catch(d){r={error:d}}finally{try{v&&!v.done&&(i=f.return)&&i.call(f)}finally{if(r)throw r.error}}}if(o)throw new $(o)}},n.prototype.add=function(e){var t;if(e&&e!==this)if(this.closed)rt(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}},n.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},n.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},n.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&F(t,e)},n.prototype.remove=function(e){var t=this._finalizers;t&&F(t,e),e instanceof n&&e._removeParent(this)},n.EMPTY=function(){var e=new n;return e.closed=!0,e}(),n}(),et=O.EMPTY;function nt(n){return n instanceof O||n&&"closed"in n&&h(n.remove)&&h(n.add)&&h(n.unsubscribe)}function rt(n){h(n)?n():n.unsubscribe()}var A={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},P={setTimeout:function(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];var i=P.delegate;return i!=null&&i.setTimeout?i.setTimeout.apply(i,L([n,e],x(t))):setTimeout.apply(void 0,L([n,e],x(t)))},clearTimeout:function(n){var e=P.delegate;return((e==null?void 0:e.clearTimeout)||clearTimeout)(n)},delegate:void 0};function it(n){P.setTimeout(function(){var e=A.onUnhandledError;if(e)e(n);else throw n})}function ot(){}var jt=function(){return R("C",void 0,void 0)}();function Ut(n){return R("E",void 0,n)}function Vt(n){return R("N",n,void 0)}function R(n,e,t){return{kind:n,value:e,error:t}}var M=null;function N(n){if(A.useDeprecatedSynchronousErrorHandling){var e=!M;if(e&&(M={errorThrown:!1,error:null}),n(),e){var t=M,r=t.errorThrown,i=t.error;if(M=null,r)throw i}}else n()}var q=function(n){S(e,n);function e(t){var r=n.call(this)||this;return r.isStopped=!1,t?(r.destination=t,nt(t)&&t.add(r)):r.destination=Rt,r}return e.create=function(t,r,i){return new J(t,r,i)},e.prototype.next=function(t){this.isStopped?z(Vt(t),this):this._next(t)},e.prototype.error=function(t){this.isStopped?z(Ut(t),this):(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped?z(jt,this):(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,n.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(O),Dt=Function.prototype.bind;function Y(n,e){return Dt.call(n,e)}var Ht=function(){function n(e){this.partialObserver=e}return n.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(r){k(r)}},n.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(r){k(r)}else k(e)},n.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){k(t)}},n}(),J=function(n){S(e,n);function e(t,r,i){var o=n.call(this)||this,s;if(h(t)||!t)s={next:t!=null?t:void 0,error:r!=null?r:void 0,complete:i!=null?i:void 0};else{var a;o&&A.useDeprecatedNextContext?(a=Object.create(t),a.unsubscribe=function(){return o.unsubscribe()},s={next:t.next&&Y(t.next,a),error:t.error&&Y(t.error,a),complete:t.complete&&Y(t.complete,a)}):s=t}return o.destination=new Ht(s),o}return e}(q);function k(n){it(n)}function $t(n){throw n}function z(n,e){var t=A.onStoppedNotification;t&&P.setTimeout(function(){return t(n,e)})}var Rt={closed:!0,next:ot,error:$t,complete:ot},G=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function j(n){return n}function qt(n){return n.length===0?j:n.length===1?n[0]:function(t){return n.reduce(function(r,i){return i(r)},t)}}var m=function(){function n(e){e&&(this._subscribe=e)}return n.prototype.lift=function(e){var t=new n;return t.source=this,t.operator=e,t},n.prototype.subscribe=function(e,t,r){var i=this,o=Jt(e)?e:new J(e,t,r);return N(function(){var s=i,a=s.operator,l=s.source;o.add(a?a.call(o,l):l?i._subscribe(o):i._trySubscribe(o))}),o},n.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},n.prototype.forEach=function(e,t){var r=this;return t=st(t),new t(function(i,o){var s=new J({next:function(a){try{e(a)}catch(l){o(l),s.unsubscribe()}},error:o,complete:i});r.subscribe(s)})},n.prototype._subscribe=function(e){var t;return(t=this.source)===null||t===void 0?void 0:t.subscribe(e)},n.prototype[G]=function(){return this},n.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return qt(e)(this)},n.prototype.toPromise=function(e){var t=this;return e=st(e),new e(function(r,i){var o;t.subscribe(function(s){return o=s},function(s){return i(s)},function(){return r(o)})})},n.create=function(e){return new n(e)},n}();function st(n){var e;return(e=n!=null?n:A.Promise)!==null&&e!==void 0?e:Promise}function Yt(n){return n&&h(n.next)&&h(n.error)&&h(n.complete)}function Jt(n){return n&&n instanceof q||Yt(n)&&nt(n)}function zt(n){return h(n==null?void 0:n.lift)}function b(n){return function(e){if(zt(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function y(n,e,t,r,i){return new Gt(n,e,t,r,i)}var Gt=function(n){S(e,n);function e(t,r,i,o,s,a){var l=n.call(this,t)||this;return l.onFinalize=s,l.shouldUnsubscribe=a,l._next=r?function(u){try{r(u)}catch(c){t.error(c)}}:n.prototype._next,l._error=o?function(u){try{o(u)}catch(c){t.error(c)}finally{this.unsubscribe()}}:n.prototype._error,l._complete=i?function(){try{i()}catch(u){t.error(u)}finally{this.unsubscribe()}}:n.prototype._complete,l}return e.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;n.prototype.unsubscribe.call(this),!r&&((t=this.onFinalize)===null||t===void 0||t.call(this))}},e}(q),Kt=H(function(n){return function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),ut=function(n){S(e,n);function e(){var t=n.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return e.prototype.lift=function(t){var r=new at(this,this);return r.operator=t,r},e.prototype._throwIfClosed=function(){if(this.closed)throw new Kt},e.prototype.next=function(t){var r=this;N(function(){var i,o;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var s=I(r.currentObservers),a=s.next();!a.done;a=s.next()){var l=a.value;l.next(t)}}catch(u){i={error:u}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(i)throw i.error}}}})},e.prototype.error=function(t){var r=this;N(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=t;for(var i=r.observers;i.length;)i.shift().error(t)}})},e.prototype.complete=function(){var t=this;N(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var r=t.observers;r.length;)r.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(t){return this._throwIfClosed(),n.prototype._trySubscribe.call(this,t)},e.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},e.prototype._innerSubscribe=function(t){var r=this,i=this,o=i.hasError,s=i.isStopped,a=i.observers;return o||s?et:(this.currentObservers=null,a.push(t),new O(function(){r.currentObservers=null,F(a,t)}))},e.prototype._checkFinalizedStatuses=function(t){var r=this,i=r.hasError,o=r.thrownError,s=r.isStopped;i?t.error(o):s&&t.complete()},e.prototype.asObservable=function(){var t=new m;return t.source=this,t},e.create=function(t,r){return new at(t,r)},e}(m),at=function(n){S(e,n);function e(t,r){var i=n.call(this)||this;return i.destination=t,i.source=r,i}return e.prototype.next=function(t){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.next)===null||i===void 0||i.call(r,t)},e.prototype.error=function(t){var r,i;(i=(r=this.destination)===null||r===void 0?void 0:r.error)===null||i===void 0||i.call(r,t)},e.prototype.complete=function(){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||r===void 0||r.call(t)},e.prototype._subscribe=function(t){var r,i;return(i=(r=this.source)===null||r===void 0?void 0:r.subscribe(t))!==null&&i!==void 0?i:et},e}(ut),Xt=function(n){S(e,n);function e(t){var r=n.call(this)||this;return r._value=t,r}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(t){var r=n.prototype._subscribe.call(this,t);return!r.closed&&t.next(this._value),r},e.prototype.getValue=function(){var t=this,r=t.hasError,i=t.thrownError,o=t._value;if(r)throw i;return this._throwIfClosed(),o},e.prototype.next=function(t){n.prototype.next.call(this,this._value=t)},e}(ut),lt={now:function(){return(lt.delegate||Date).now()},delegate:void 0},Wt=function(n){S(e,n);function e(t,r){return n.call(this)||this}return e.prototype.schedule=function(t,r){return this},e}(O),U={setInterval:function(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];var i=U.delegate;return i!=null&&i.setInterval?i.setInterval.apply(i,L([n,e],x(t))):setInterval.apply(void 0,L([n,e],x(t)))},clearInterval:function(n){var e=U.delegate;return((e==null?void 0:e.clearInterval)||clearInterval)(n)},delegate:void 0},Zt=function(n){S(e,n);function e(t,r){var i=n.call(this,t,r)||this;return i.scheduler=t,i.work=r,i.pending=!1,i}return e.prototype.schedule=function(t,r){if(r===void 0&&(r=0),this.closed)return this;this.state=t;var i=this.id,o=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(o,i,r)),this.pending=!0,this.delay=r,this.id=this.id||this.requestAsyncId(o,this.id,r),this},e.prototype.requestAsyncId=function(t,r,i){return i===void 0&&(i=0),U.setInterval(t.flush.bind(t,this),i)},e.prototype.recycleAsyncId=function(t,r,i){if(i===void 0&&(i=0),i!=null&&this.delay===i&&this.pending===!1)return r;U.clearInterval(r)},e.prototype.execute=function(t,r){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var i=this._execute(t,r);if(i)return i;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,r){var i=!1,o;try{this.work(t)}catch(s){i=!0,o=s||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),o},e.prototype.unsubscribe=function(){if(!this.closed){var t=this,r=t.id,i=t.scheduler,o=i.actions;this.work=this.state=this.scheduler=null,this.pending=!1,F(o,this),r!=null&&(this.id=this.recycleAsyncId(i,r,null)),this.delay=null,n.prototype.unsubscribe.call(this)}},e}(Wt),ct=function(){function n(e,t){t===void 0&&(t=n.now),this.schedulerActionCtor=e,this.now=t}return n.prototype.schedule=function(e,t,r){return t===void 0&&(t=0),new this.schedulerActionCtor(this,e).schedule(r,t)},n.now=lt.now,n}(),Qt=function(n){S(e,n);function e(t,r){r===void 0&&(r=ct.now);var i=n.call(this,t,r)||this;return i.actions=[],i._active=!1,i._scheduled=void 0,i}return e.prototype.flush=function(t){var r=this.actions;if(this._active){r.push(t);return}var i;this._active=!0;do if(i=t.execute(t.state,t.delay))break;while(t=r.shift());if(this._active=!1,i){for(;t=r.shift();)t.unsubscribe();throw i}},e}(ct),te=new Qt(Zt),ft=new m(function(n){return n.complete()});function ee(n){return n&&h(n.schedule)}function ht(n){return n[n.length-1]}function ne(n){return ee(ht(n))?n.pop():void 0}function re(n,e){return typeof ht(n)=="number"?n.pop():e}var dt=function(n){return n&&typeof n.length=="number"&&typeof n!="function"};function pt(n){return h(n==null?void 0:n.then)}function vt(n){return h(n[G])}function mt(n){return Symbol.asyncIterator&&h(n==null?void 0:n[Symbol.asyncIterator])}function yt(n){return new TypeError("You provided "+(n!==null&&typeof n=="object"?"an invalid object":"'"+n+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function ie(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var bt=ie();function St(n){return h(n==null?void 0:n[bt])}function wt(n){return Nt(this,arguments,function(){var t,r,i,o;return tt(this,function(s){switch(s.label){case 0:t=n.getReader(),s.label=1;case 1:s.trys.push([1,,9,10]),s.label=2;case 2:return[4,_(t.read())];case 3:return r=s.sent(),i=r.value,o=r.done,o?[4,_(void 0)]:[3,5];case 4:return[2,s.sent()];case 5:return[4,_(i)];case 6:return[4,s.sent()];case 7:return s.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}function gt(n){return h(n==null?void 0:n.getReader)}function E(n){if(n instanceof m)return n;if(n!=null){if(vt(n))return oe(n);if(dt(n))return se(n);if(pt(n))return ue(n);if(mt(n))return Et(n);if(St(n))return ae(n);if(gt(n))return le(n)}throw yt(n)}function oe(n){return new m(function(e){var t=n[G]();if(h(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function se(n){return new m(function(e){for(var t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function ue(n){return new m(function(e){n.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,it)})}function ae(n){return new m(function(e){var t,r;try{for(var i=I(n),o=i.next();!o.done;o=i.next()){var s=o.value;if(e.next(s),e.closed)return}}catch(a){t={error:a}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}e.complete()})}function Et(n){return new m(function(e){ce(n,e).catch(function(t){return e.error(t)})})}function le(n){return Et(wt(n))}function ce(n,e){var t,r,i,o;return Mt(this,void 0,void 0,function(){var s,a;return tt(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),t=kt(n),l.label=1;case 1:return[4,t.next()];case 2:if(r=l.sent(),!!r.done)return[3,4];if(s=r.value,e.next(s),e.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=l.sent(),i={error:a},[3,11];case 6:return l.trys.push([6,,9,10]),r&&!r.done&&(o=t.return)?[4,o.call(t)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function g(n,e,t,r,i){r===void 0&&(r=0),i===void 0&&(i=!1);var o=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(o),!i)return o}function It(n,e){return e===void 0&&(e=0),b(function(t,r){t.subscribe(y(r,function(i){return g(r,n,function(){return r.next(i)},e)},function(){return g(r,n,function(){return r.complete()},e)},function(i){return g(r,n,function(){return r.error(i)},e)}))})}function xt(n,e){return e===void 0&&(e=0),b(function(t,r){r.add(n.schedule(function(){return t.subscribe(r)},e))})}function fe(n,e){return E(n).pipe(xt(e),It(e))}function he(n,e){return E(n).pipe(xt(e),It(e))}function de(n,e){return new m(function(t){var r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function pe(n,e){return new m(function(t){var r;return g(t,e,function(){r=n[bt](),g(t,e,function(){var i,o,s;try{i=r.next(),o=i.value,s=i.done}catch(a){t.error(a);return}s?t.complete():t.next(o)},0,!0)}),function(){return h(r==null?void 0:r.return)&&r.return()}})}function Lt(n,e){if(!n)throw new Error("Iterable cannot be null");return new m(function(t){g(t,e,function(){var r=n[Symbol.asyncIterator]();g(t,e,function(){r.next().then(function(i){i.done?t.complete():t.next(i.value)})},0,!0)})})}function ve(n,e){return Lt(wt(n),e)}function me(n,e){if(n!=null){if(vt(n))return fe(n,e);if(dt(n))return de(n,e);if(pt(n))return he(n,e);if(mt(n))return Lt(n,e);if(St(n))return pe(n,e);if(gt(n))return ve(n,e)}throw yt(n)}function ye(n,e){return e?me(n,e):E(n)}var _t=H(function(n){return function(){n(this),this.name="EmptyError",this.message="no elements in sequence"}});function K(n,e){return b(function(t,r){var i=0;t.subscribe(y(r,function(o){r.next(n.call(e,o,i++))}))})}function be(n,e,t,r,i,o,s,a){var l=[],u=0,c=0,p=!1,f=function(){p&&!l.length&&!u&&e.complete()},v=function(d){return u<r?w(d):l.push(d)},w=function(d){o&&e.next(d),u++;var Pt=!1;E(t(d,c++)).subscribe(y(e,function(C){i==null||i(C),o?v(C):e.next(C)},function(){Pt=!0},void 0,function(){if(Pt)try{u--;for(var C=function(){var V=l.shift();s?g(e,s,function(){return w(V)}):w(V)};l.length&&u<r;)C();f()}catch(V){e.error(V)}}))};return n.subscribe(y(e,v,function(){p=!0,f()})),function(){a==null||a()}}function Tt(n,e,t){return t===void 0&&(t=1/0),h(e)?Tt(function(r,i){return K(function(o,s){return e(r,o,i,s)})(E(n(r,i)))},t):(typeof e=="number"&&(t=e),b(function(r,i){return be(r,i,n,t)}))}function Se(n){return n===void 0&&(n=1/0),Tt(j,n)}function Ot(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=ne(n),r=re(n,1/0),i=n;return i.length?i.length===1?E(i[0]):Se(r)(ye(i,t)):ft}function At(n,e){return b(function(t,r){var i=0;t.subscribe(y(r,function(o){return n.call(e,o,i++)&&r.next(o)}))})}function we(n,e){return e===void 0&&(e=te),b(function(t,r){var i=null,o=null,s=null,a=function(){if(i){i.unsubscribe(),i=null;var u=o;o=null,r.next(u)}};function l(){var u=s+n,c=e.now();if(c<u){i=this.schedule(void 0,u-c),r.add(i);return}a()}t.subscribe(y(r,function(u){o=u,s=e.now(),i||(i=e.schedule(l,n),r.add(i))},function(){a(),r.complete()},void 0,function(){o=i=null}))})}function ge(n){return b(function(e,t){var r=!1;e.subscribe(y(t,function(i){r=!0,t.next(i)},function(){r||t.next(n),t.complete()}))})}function Ee(n){return n<=0?function(){return ft}:b(function(e,t){var r=0;e.subscribe(y(t,function(i){++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function Ie(n,e){return e===void 0&&(e=j),n=n!=null?n:xe,b(function(t,r){var i,o=!0;t.subscribe(y(r,function(s){var a=e(s);(o||!n(i,a))&&(o=!1,i=a,r.next(s))}))})}function xe(n,e){return n===e}function Le(n){return n===void 0&&(n=_e),b(function(e,t){var r=!1;e.subscribe(y(t,function(i){r=!0,t.next(i)},function(){return r?t.complete():t.error(n())}))})}function _e(){return new _t}function Te(n,e){var t=arguments.length>=2;return function(r){return r.pipe(n?At(function(i,o){return n(i,o,r)}):j,Ee(1),t?ge(e):Le(function(){return new _t}))}}function Oe(n,e){return b(function(t,r){var i=null,o=0,s=!1,a=function(){return s&&!i&&r.complete()};t.subscribe(y(r,function(l){i==null||i.unsubscribe();var u=0,c=o++;E(n(l,c)).subscribe(i=y(r,function(p){return r.next(e?e(l,p,c,u++):p)},function(){i=null,a()}))},function(){s=!0,a()}))})}const Ae=10,T={searchBoxList:{defaultClassName:"searchBoxList",itemDefaultClassName:"searchBoxList__item",itemButtonDefaultClassName:"searchBoxList__itemButton",messageClassName:"searchBoxList__message",loadingIndicatorClassName:"searchBoxList__loadingIndicator"},searchBoxInput:{defaultClassName:"searchBox__input"}},Ct={noResultsFound:"Sorry, can't find a match for your search phrase!",loading:"Loading your results\u2026"};class X{constructor(e){this.element=e,this.eventListeners=[]}addListener(e,t){this.element.addEventListener(e,t),this.eventListeners.push({type:e,fn:t})}dispose(){this.eventListeners.forEach(({type:e,fn:t})=>{this.element.removeEventListener(e,t)}),this.eventListeners.length=0,this.element=null}}var Ce=Object.defineProperty,Bt=Object.getOwnPropertySymbols,Be=Object.prototype.hasOwnProperty,Fe=Object.prototype.propertyIsEnumerable,Ft=(n,e,t)=>e in n?Ce(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,W=(n,e)=>{for(var t in e||(e={}))Be.call(e,t)&&Ft(n,t,e[t]);if(Bt)for(var t of Bt(e))Fe.call(e,t)&&Ft(n,t,e[t]);return n};class Z{constructor(e){this.lastBroadcastedState=null,this.lastBroadcastedState=W({},e),this.compareState=this.defaultCompareState,this.stateSource=new Xt(this.lastBroadcastedState),this._state$=this.stateSource.pipe(Ie(this.compareState))}static areEqualShallow(e,t){for(let r in e)if(!(r in t)||e[r]!==t[r])return!1;for(let r in t)if(!(r in e))return!1;return!0}get state$(){return this._state$}setState(e){this.lastBroadcastedState=W(W({},this.lastBroadcastedState),e),this.stateSource.next(this.lastBroadcastedState)}defaultCompareState(e,t){return Z.areEqualShallow(e,t)}}function Pe(n,e){if(!n||!e||!n.contains(e))return null;if(n===e)return[n];const t=[e];let r=e;for(;r.parentNode&&r.parentNode!==n;)r=r.parentNode,t.unshift(r);return t.unshift(n),t}class Me{constructor(e,t={}){this.inputElement=e,this.options=t,this.browserEventManager=null,this.browserEventManager=new X(this.inputElement),this.browserEventManager.addListener("focus",()=>{this.options.onFocus&&this.options.onFocus()}),this.browserEventManager.addListener("blur",()=>{this.options.onBlur&&this.options.onBlur()}),this.browserEventManager.addListener("input",r=>{const i=r.target;this.options.onValueChange&&this.options.onValueChange(i.value)})}setFocus(){this.inputElement.focus()}dispose(){this.inputElement=null,this.browserEventManager.dispose()}}class Q{constructor(e,t,r={}){this.inputElement=e,this.itemTemplate=t,this.options=r,this.listElementEvents=null,this.documentEvents=null,this.listElement=null,this.items=[],this.visible=!1,this.isFocused=!1,this.initializeListElement(),this.listElementEvents=new X(this.listElement),this.documentEvents=new X(window.document.documentElement),this.listElement.style.position="fixed",this.listElement.style.zIndex=String(Ae),this.listElementEvents.addListener("mousedown",i=>{this.setFocus()}),this.listElementEvents.addListener("click",i=>{const o=i.target;if(o instanceof HTMLElement){const s=this.getSelectedItem(o);this.options.onItemSelect(s)}}),this.documentEvents.addListener("mousedown",i=>{const o=i.target;this.isFocused&&!this.listElement.contains(o)&&this.blur()})}static escapeHTML(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}setItems(e){const{searchBoxList:{messageClassName:t}}=T;this.clearList(),e.length?(this.items=e,this.items.forEach((r,i)=>{this.listElement.appendChild(this.createListItem(r,i))})):this.listElement.innerHTML=`<div class="${t}">${Ct.noResultsFound}</div>`}beginLoading(){const{searchBoxList:{messageClassName:e,loadingIndicatorClassName:t}}=T;this.clearList(),this.listElement.innerHTML=`
            <div class="${e}">
                <div class="${t}"></div>
                ${Ct.loading}
            </div>
        `}show(){const{bottom:e,right:t}=this.inputElement.getBoundingClientRect(),r=document.documentElement.clientWidth;this.listElement.style.display="block",this.listElement.style.top=`${e}px`,this.listElement.style.right=`${r-t}px`,this.visible=!0}hide(){this.visible&&(this.visible=!1,this.listElement.style.display="none",this.blur())}setFocus(){this.isFocused||(this.isFocused=!0,this.options.onFocus&&this.options.onFocus())}blur(){this.isFocused&&(this.isFocused=!1,this.options.onBlur&&this.options.onBlur())}dispose(){this.inputElement=null,this.listElementEvents.dispose(),this.documentEvents.dispose()}getSelectedItem(e){const{searchBoxList:{itemButtonDefaultClassName:t}}=T,r=Pe(this.listElement,e),i=r==null?void 0:r.find(o=>o.tagName==="BUTTON"&&o.classList.contains(t));if((i==null?void 0:i.tagName)==="BUTTON"&&i.classList.contains(t)){const o=typeof(i==null?void 0:i.dataset.index)=="string"?Number(i.dataset.index):null;return this.items[o]||null}else return null}clearList(){this.items=[],this.listElement.innerHTML=""}initializeListElement(){const{searchBoxList:{defaultClassName:e}}=T;this.listElement=document.createElement("ul"),this.listElement.classList.add(e),this.listElement.style.display="none",document.body.append(this.listElement),this.beginLoading()}createListItem(e,t){const r=document.createElement("li"),i=document.createElement("button"),o=this.getItemHTML(e,this.itemTemplate),{searchBoxList:{itemButtonDefaultClassName:s,itemDefaultClassName:a}}=T;return i.setAttribute("data-index",String(t)),i.setAttribute("type","button"),i.innerHTML=o,i.classList.add(s),r.appendChild(i),r.classList.add(a),r}getItemHTML(e,t){return t.replace(/{{(.+)}}/g,(r,i)=>{var o;const s=i.trim(),a=(o=e[s])!=null?o:null,l=a===null?"":String(a);return Q.escapeHTML(l)})}}class Ne{constructor(e,t,r,i,o={}){if(this.inputElement=e,this.dataSource=t,this.itemTemplate=r,this.searchKeys=i,this.options=o,this.input=null,this.resultList=null,this.isInitializing=!1,this.isInitialized=!1,this.state=null,!(e instanceof HTMLInputElement))throw new Error("Input element must be a valid HTMLInputElement!");e.classList.add(T.searchBoxInput.defaultClassName),this.state=new Z({inputFocused:!1,resultListFocused:!1,inputValue:"",selectedItem:null}),this.input=new Me(e,{onFocus:()=>this.state.setState({inputFocused:!0,resultListFocused:!1}),onBlur:()=>this.state.setState({inputFocused:!1}),onValueChange:u=>this.state.setState({inputValue:u})}),this.resultList=new Q(e,r,{onFocus:()=>this.state.setState({resultListFocused:!0}),onBlur:()=>this.state.setState({resultListFocused:!1}),onItemSelect:u=>this.state.setState({selectedItem:u})}),this.stateSubscription=this.state.state$.subscribe(u=>this.onStateChange(u));const s=this.state.state$.pipe(Te(u=>u==null?void 0:u.inputFocused),K(()=>"")),a=this.state.state$.pipe(At(u=>!(u!=null&&u.inputValue)||(u==null?void 0:u.inputValue.length)>=3),K(u=>u.inputValue||""),we(500)),l=Ot(s,a).pipe(Oe(u=>this.dataSource.getItems(u,10,this.searchKeys)));this.inputValueSubscription=Ot(s,a).subscribe(u=>{console.log("input says",u)}),this.inputItemsSubscription=l.subscribe(u=>{this.resultList.setItems(u)})}dispose(){this.input.dispose(),this.resultList.dispose(),this.inputElement=null,this.stateSubscription.unsubscribe(),this.inputValueSubscription.unsubscribe()}onStateChange(e){console.log("state changed",e),e.selectedItem&&this.options.onItemSelect&&this.options.onItemSelect(e.selectedItem),e.inputFocused?this.resultList.show():e.resultListFocused||this.resultList.hide()}}class ke{constructor(e){this.url=e,this.items=null}getItems(e,t,r){return this.items||(this.items=this.waitForIt(1e3).then(()=>this.fetchJSON(this.url))),this.items.then(i=>this.filterItems(i,e,r))}async fetchJSON(e){return fetch(e).then(t=>{if(t.ok)return t.json();throw new Error(`Request to fetch JSON data for the SearchBox has failed with status code ${t.status}`)})}filterItems(e,t,r){return t.length<2?e:(t=t.toLowerCase(),e.filter(i=>r.some(o=>{const s=i[o];return s&&String(s).toLowerCase().includes(t)})))}waitForIt(e){return new Promise(t=>{setTimeout(()=>t(),e)})}}return B.SearchBox=Ne,B.SearchBoxJSONDataSource=ke,Object.defineProperty(B,"__esModule",{value:!0}),B}({});
//# sourceMappingURL=searchboxjs.min.js.map
